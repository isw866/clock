<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¸“ä¸šæ ¸å¿ƒå²—ä½åŒ¹é…ç³»ç»Ÿ</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        :root {
            --primary-blue: #2563eb;
            --primary-light: #eff6ff;
            --primary-gradient: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            --accent-cyan: #06b6d4;
            --status-green: #10b981;
            --status-orange: #f59e0b;
            --status-red: #ef4444;
            --status-bg-green: #d1fae5;
            --bg-body: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #0f172a;
            --text-sub: #64748b;
            --border-light: #e2e8f0;
            --card-radius: 16px;
            --shadow-blue: 0 4px 20px -2px rgba(37, 99, 235, 0.1);
        }

        body {
            margin: 0;
            background: var(--bg-body);
            color: var(--text-main);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: 80px;
        }

        .hide-scrollbar::-webkit-scrollbar { display: none; }

        /* --- é¦–é¡µæ ·å¼ --- */
        .home-header { padding: 32px 20px 50px; background: var(--primary-gradient); color: #fff; border-bottom-left-radius: 24px; border-bottom-right-radius: 24px; box-shadow: 0 4px 12px rgba(30, 64, 175, 0.2); position: relative; z-index: 1; }
        .home-title { font-size: 24px; font-weight: 800; letter-spacing: 0.5px; }
        .home-subtitle { font-size: 13px; opacity: 0.8; margin-top: 6px; font-weight: 400; }
        .list-container { padding: 0 16px 20px; margin-top: -30px; position: relative; z-index: 2; }
        .job-card { background: var(--card-bg); border-radius: var(--card-radius); padding: 20px; margin-bottom: 16px; box-shadow: var(--shadow-blue); border: 1px solid rgba(255,255,255,0.6); transition: transform 0.2s; position: relative; overflow: hidden; }
        .job-card:active { transform: scale(0.98); }
        .job-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .job-name { font-size: 18px; font-weight: 700; color: #1e293b; }
        .job-tag { font-size: 11px; color: var(--primary-blue); background: var(--primary-light); padding: 4px 10px; border-radius: 20px; font-weight: 600; }
        .job-desc-preview { font-size: 13px; color: var(--text-sub); line-height: 1.6; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; margin-bottom: 16px; }
        .job-card-footer { font-size: 12px; color: #94a3b8; border-top: 1px solid #f1f5f9; padding-top: 12px; display: flex; justify-content: space-between; align-items: center; }
        .link-text { color: var(--primary-blue); font-weight: 600; display: flex; align-items: center; }

        /* --- è¯¦æƒ…é¡µæ ·å¼ --- */
        .detail-action-bar { position: fixed; bottom: 0; left: 0; right: 0; height: 80px; background: #fff; display: flex; align-items: center; padding: 0 16px; box-shadow: 0 -4px 12px rgba(0,0,0,0.05); z-index: 99; border-top: 1px solid var(--border-light); padding-bottom: env(safe-area-inset-bottom); }
        .fav-btn { width: 48px; height: 48px; border-radius: 12px; background: #f1f5f9; display: flex; align-items: center; justify-content: center; margin-right: 12px; transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .fav-btn.active { background: #fee2e2; transform: scale(1.05); }
        .fav-btn.active svg { fill: #ef4444; stroke: #ef4444; }
        .submit-btn { flex: 1; height: 48px; border-radius: 12px; background: var(--primary-gradient); color: #fff; font-weight: 700; font-size: 16px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2); }
        .submit-btn:active { opacity: 0.9; transform: scale(0.99); }

        /* --- å¯¼èˆªæ  --- */
        .tab-bar { position: fixed; bottom: 0; left: 0; right: 0; height: 64px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); display: flex; align-items: center; justify-content: space-around; border-top: 1px solid var(--border-light); box-shadow: 0 -4px 12px rgba(0,0,0,0.05); z-index: 1000; }
        .tab-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-sub); font-size: 12px; font-weight: 600; cursor: pointer; }
        .tab-item.active { color: var(--primary-blue); }
        .tab-icon { width: 24px; height: 24px; margin-bottom: 4px; fill: currentColor; }

        /* --- è¯¦æƒ…é¡µå†…å®¹ --- */
        .nav-bar { position: sticky; top: 0; z-index: 100; background: var(--primary-gradient); height: 56px; display: flex; align-items: center; justify-content: center; padding: 0 16px; color: #fff; }
        .nav-left-area { position: absolute; left: 8px; height: 100%; display: flex; align-items: center; padding: 0 12px; }
        .nav-right-area { position: absolute; right: 8px; height: 100%; display: flex; align-items: center; padding: 0 12px; font-size: 13px; font-weight: 600; opacity: 0.9; cursor: pointer; }
        .back-icon-svg { width: 24px; height: 24px; fill: #fff; }
        .nav-title { font-size: 17px; font-weight: 600; }
        .detail-content { padding: 20px 16px 140px; }

        /* åŸºç¡€ç»„ä»¶ */
        .header-info-card { background: var(--card-bg); border-radius: var(--card-radius); padding: 24px 20px; margin-bottom: 20px; position: relative; box-shadow: var(--shadow-blue); }
        .status-badge { position: absolute; top: 0; right: 0; background: var(--status-bg-green); color: var(--status-green); font-size: 11px; font-weight: 700; padding: 6px 14px; border-bottom-left-radius: 16px; border-top-right-radius: 16px; }
        .rank-card { background: var(--card-bg); border-radius: var(--card-radius); padding: 24px 16px; margin-bottom: 20px; box-shadow: var(--shadow-blue); }
        .rank-stats { display: flex; justify-content: space-around; text-align: center; }
        .stat-item { flex: 1; position: relative; display: flex; flex-direction: column; align-items: center; }
        .stat-item:not(:last-child)::after { content: ""; position: absolute; right: 0; top: 15%; height: 70%; width: 1px; background: #e2e8f0; }
        .stat-circle-wrapper { width: 52px; height: 52px; margin-bottom: 8px; display: flex; justify-content: center; align-items: center; }
        .stat-circle { width: 36px; height: 36px; border-radius: 8px; border: 3px solid #eef2ff; transform: rotate(-45deg); display: flex; align-items: center; justify-content: center; background: #fff; }
        .stat-circle span { transform: rotate(45deg); font-size: 12px; font-weight: 800; }
        .stat-value { font-size: 20px; font-weight: 800; color: var(--primary-blue); margin-bottom: 2px; }
        .stat-label { font-size: 11px; color: var(--text-sub); }
        .section-header { font-size: 17px; font-weight: 800; margin: 28px 4px 14px; display: flex; align-items: center; }
        .section-header::before { content: ""; width: 4px; height: 16px; background: var(--primary-blue); border-radius: 4px; margin-right: 10px; }
        .desc-card { background: #fff; border-radius: var(--card-radius); padding: 20px; line-height: 1.7; font-size: 14px; color: #475569; box-shadow: var(--shadow-blue); }
        .filter-box { background: #fff; border-radius: 12px; padding: 14px; margin-bottom: 14px; display: flex; align-items: center; justify-content: space-between; border: 1px solid var(--border-light); }
        .custom-select { border: none; background: #f8fafc; padding: 8px 16px; border-radius: 8px; font-size: 13px; color: var(--primary-blue); font-weight: 700; outline: none; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%232563eb' d='M6 8.825L1.175 4L2.238 2.938L6 6.713L9.763 2.938L10.825 4L6 8.825Z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 8px center; padding-right: 24px; }

        .matrix-wrapper { background: #fff; border-radius: var(--card-radius); overflow: hidden; border: 1px solid var(--border-light); box-shadow: var(--shadow-blue); margin-bottom: 16px;}
        .scroll-container { overflow-x: auto; }
        table { border-collapse: separate; border-spacing: 0; width: 100%; }
        th, td { padding: 14px 12px; text-align: center; border-bottom: 1px solid #f1f5f9; font-size: 13px; white-space: nowrap; }
        .sticky-col { position: sticky; left: 0; background: #fff; z-index: 2; text-align: left; min-width: 120px; font-weight: 600; border-right: 1px solid #f1f5f9; }
        thead th { background: #f8fafc; color: #64748b; font-size: 12px; border-bottom: 2px solid #e2e8f0; }
        .dot-check { color: var(--primary-blue); font-weight: 900; font-size: 16px; display: inline-block; width: 20px; height: 20px; line-height: 20px; background: rgba(37, 99, 235, 0.1); border-radius: 50%; }

        .chart-card { background: #fff; border-radius: var(--card-radius); padding: 20px; box-shadow: var(--shadow-blue); border: 1px solid var(--border-light); margin-top: 16px;}
        .chart-container { width: 100%; height: 500px; }
        .chart-tip { font-size: 12px; color: var(--text-sub); text-align: center; margin-top: 8px; }

        /* --- æˆ‘çš„å²—ä½é¡µé¢ä¸“å±æ ·å¼ --- */
        .mine-content { padding: 16px; padding-bottom: 80px; }

        /* ç»Ÿè®¡é¢æ¿ */
        .stats-panel { display: flex; gap: 12px; margin-bottom: 20px; }
        .stat-box { flex: 1; background: #fff; padding: 16px; border-radius: 12px; box-shadow: var(--shadow-blue); text-align: center; border: 1px solid #fff; position: relative; overflow: hidden; }
        .stat-box.highlight { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: #fff; }
        .stat-box.highlight .sb-label { color: rgba(255,255,255,0.8); }
        .stat-box.highlight .sb-value { color: #fff; }
        .sb-value { font-size: 24px; font-weight: 800; color: var(--text-main); margin-bottom: 4px; display: block; }
        .sb-label { font-size: 12px; color: var(--text-sub); }
        .sb-sub { font-size: 11px; color: var(--status-green); font-weight: 600; margin-top: 4px; display: block; }

        /* é›·è¾¾å›¾å¡ç‰‡ */
        .radar-card { background: #fff; border-radius: var(--card-radius); padding: 20px; margin-bottom: 20px; box-shadow: var(--shadow-blue); position: relative; border: 1px solid var(--border-light); }
        .radar-chart { width: 100%; height: 260px; }

        /* åˆæ ¼å°ç«  */
        .stamp-seal {
            position: absolute; top: 10px; right: 10px; width: 80px; height: 80px;
            border: 3px solid var(--status-green); border-radius: 50%; color: var(--status-green);
            display: flex; align-items: center; justify-content: center;
            font-size: 16px; font-weight: 900; transform: rotate(-20deg);
            opacity: 0; transition: opacity 0.5s, transform 0.5s; pointer-events: none;
            background: rgba(16, 185, 129, 0.05); z-index: 10;
        }
        .stamp-seal.show { opacity: 1; transform: rotate(-20deg) scale(1); }
        .stamp-inner { border: 1px dashed var(--status-green); width: 68px; height: 68px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }

        /* æˆç»©åˆ—è¡¨è¡¨æ ¼ */
        .score-table-wrap { background: #fff; border-radius: 12px; overflow: hidden; border: 1px solid var(--border-light); box-shadow: 0 2px 8px rgba(0,0,0,0.03); margin-bottom: 20px; }
        .score-row { display: flex; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid #f1f5f9; align-items: center; }
        .score-row:last-child { border-bottom: none; }
        .score-name { font-size: 13px; color: var(--text-main); font-weight: 500; flex: 1; }
        .score-credit { font-size: 12px; color: var(--text-sub); width: 50px; text-align: right; }
        .score-val { font-size: 13px; font-weight: 700; width: 50px; text-align: right; }
        .val-pass { color: var(--status-green); }
        .val-fail { color: var(--status-red); }

    </style>
</head>
<body>

<div id="app">
    <!-- List & Detail Tab -->
    <div v-show="currentTab === 'list'">
        <div v-if="page === 'list'">
            <div class="home-header">
                <div class="home-title">è¯å“ç»è¥ä¸ç®¡ç† ä¸“ä¸šæ ¸å¿ƒå²—ä½</div>
                <div class="home-subtitle">åŸºäºå›¾è°±å¼•æ“çš„æ™ºèƒ½å²—ä½åŒ¹é…ç³»ç»Ÿ</div>
            </div>
            <div class="list-container">
                <div v-for="item in jobs" :key="item.name" class="job-card" @click="openDetail(item)">
                    <div class="job-card-header">
                        <div class="job-name">{{ item.name }}</div>
<!--                        <div class="job-tag">{{ item.dept }}</div>-->
                    </div>
                    <div class="job-desc-preview">{{ item.fullDesc }}</div>
                    <div class="job-card-footer">
                        <div>
                            <span style="margin-right: 10px; display: inline-flex; align-items: center;">
                                <span style="width:6px; height:6px; background:#cbd5e1; border-radius:50%; margin-right:4px;"></span>
                                {{ item.matrix.length }} é¡¹èƒ½åŠ›
                            </span>
                            <span style="margin-right: 10px; display: inline-flex; align-items: center;">
                                <span style="width:6px; height:6px; background:#cbd5e1; border-radius:50%; margin-right:4px;"></span>
                                {{ getCourseCount(item) }} é—¨è¯¾ç¨‹
                            </span>
                        </div>
                        <span class="link-text">åŒ¹é…è¯¦æƒ… &rsaquo;</span>
                    </div>
                </div>
            </div>
        </div>

        <div v-else>
            <div class="nav-bar">
                <div class="nav-left-area" @click="page = 'list'">
                    <svg class="back-icon-svg" viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
                </div>
                <div class="nav-title">å²—ä½è¯¦æƒ…</div>
            </div>

            <div class="detail-content">
                <div class="header-info-card">
                    <div class="status-badge">æ­£åœ¨æŠ¥å</div>
                    <div style="font-size: 22px; font-weight: 800; margin-bottom: 6px; color: #1e293b;">{{ activeJob.name }}</div>
                    <div style="font-size: 13px; color: var(--text-sub);">
                        <span style="background: #f1f5f9; padding: 2px 8px; border-radius: 4px;">{{ activeJob.dept }}</span> | ä»£ç ï¼š{{ activeJob.code }}
                    </div>
                </div>

                <div class="section-header">å²—ä½ç«äº‰åŠ›</div>
                <div class="rank-card">
                    <div class="rank-stats">
                        <div class="stat-item">
                            <div class="stat-circle-wrapper">
                                <div class="stat-circle" :style="{ borderTopColor: getStatusColor(activeJob.stats.myLevel), borderRightColor: getStatusColor(activeJob.stats.myLevel) }">
                                    <span :style="{ color: getStatusColor(activeJob.stats.myLevel) }">{{ activeJob.stats.myLevel }}</span>
                                </div>
                            </div>
                            <div class="stat-label">æˆ‘çš„åŒ¹é…åº¦</div>
                        </div>
                        <div class="stat-item"><div class="stat-value">{{ activeJob.stats.favCount }}</div><div class="stat-label">æ”¶è—äººæ•°</div></div>
                        <div class="stat-item"><div class="stat-value green">{{ activeJob.stats.selectCount }}</div><div class="stat-label">å·²é€‰äººæ•°</div></div>
                    </div>
                </div>

                <div class="section-header">å²—ä½ä¿¡æ¯</div>
                <div class="desc-card">{{ activeJob.fullDesc }}</div>

                <div class="section-header">èƒ½åŠ›ä¸è¯¾ç¨‹çŸ©é˜µ</div>
                <div class="filter-box">
                    <span class="filter-label">é€‰æ‹©å­¦æœŸ</span>
                    <select v-model="selectedSemester" class="custom-select" @change="updateChart">
                        <option v-for="opt in semesterOptions" :key="opt" :value="opt">{{ opt }}</option>
                    </select>
                </div>

                <div class="matrix-wrapper">
                    <div class="scroll-container hide-scrollbar">
                        <table>
                            <thead><tr><th class="sticky-col">èŒä¸šèƒ½åŠ›è¦æ±‚</th><th v-for="c in currentSemesterCourses">{{ c }}</th></tr></thead>
                            <tbody>
                            <tr v-for="row in activeJob.matrix">
                                <td class="sticky-col">{{ row.name }}</td>
                                <td v-for="course in currentSemesterCourses">
                                    <span v-if="row.activeCourses.includes(course)" class="dot-check">âœ“</span>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="section-header">å²—ä½èƒ½åŠ›å›¾è°±</div>
                <div class="chart-card">
                    <div id="sankeyChart" class="chart-container"></div>
                    <div class="chart-tip">ğŸ’¡ æç¤ºï¼šå›¾è°±å†…å®¹å·²æ ¹æ®ä¸Šæ–¹é€‰æ‹©çš„ã€{{ selectedSemester }}ã€‘åŠ¨æ€æ›´æ–°</div>
                </div>
            </div>

            <div class="detail-action-bar">
                <div class="fav-btn" :class="{ active: activeJob.isFav }" @click="toggleFavorite">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                    </svg>
                </div>
                <div class="submit-btn" @click="goToMyJobs">ç«‹å³é€‰å²—</div>
            </div>
        </div>
    </div>

    <!-- Mine Tab -->
    <div v-show="currentTab === 'mine'">
        <div class="nav-bar">
            <div class="nav-title">æˆ‘çš„ç›®æ ‡å²—ä½</div>
            <!-- é‡é€‰æŒ‰é’® -->
            <div class="nav-right-area" @click="currentTab = 'list'; page = 'list'">
                <span>â†» é‡é€‰</span>
            </div>
        </div>

        <div class="mine-content">
            <!-- 1. é¡¶éƒ¨ï¼šé€‰å®šå²—ä½å¡ç‰‡ -->
            <div class="job-card" style="border: 2px solid var(--primary-blue); background: #f0f7ff;">
                <div style="position: absolute; right: 0; top: 0; background: var(--primary-blue); color: #fff; padding: 4px 12px; font-size: 11px; font-weight: 700; border-bottom-left-radius: 12px;">å½“å‰ç›®æ ‡</div>
                <div class="job-card-header">
                    <div class="job-name">{{ myJob.name }}</div>
                    <div class="job-tag">{{ myJob.dept }}</div>
                </div>
                <div class="job-desc-preview" style="margin-bottom: 8px;">{{ myJob.fullDesc }}</div>
            </div>

            <!-- 2. ä¸­éƒ¨ï¼šæ•°æ®ç»Ÿè®¡ä»ªè¡¨ç›˜ -->
            <div class="section-header">å­¦æƒ…æ€»è§ˆ</div>
            <div class="stats-panel">
                <div class="stat-box">
<!--                    <div class="stat-box highlight">-->
                    <span class="sb-value">{{ myStats.avgScore }}</span>
                    <span class="sb-label">åŠ æƒå¹³å‡åˆ†</span>
                    <span class="sb-sub">ç›®æ ‡: 80+</span>
                </div>
                <div class="stat-box">
                    <span class="sb-value">{{ myStats.earnedCredits }} <span style="font-size:12px;color:#94a3b8">/ {{ myStats.totalCredits }}</span></span>
                    <span class="sb-label">å·²ä¿®å­¦åˆ†</span>
                    <span class="sb-sub" :style="{color: myStats.progress >= 80 ? '#10b981' : '#f59e0b'}">è¿›åº¦ {{ myStats.progress }}%</span>
                </div>
            </div>

            <!-- 3. é›·è¾¾å›¾ï¼šå²—ä½åŒ¹é…æ¨¡å‹ -->
            <div class="section-header">èƒ½åŠ›è¾¾æˆæƒ…å†µ</div>
            <div class="radar-card">
                <!-- åˆæ ¼å°ç«  -->
                <div class="stamp-seal" :class="{ show: isQualified }">
                    <div class="stamp-inner">åˆæ ¼</div>
                </div>
                <div id="radarChart" class="radar-chart"></div>
                <div style="text-align: center; font-size: 12px; color: #64748b; margin-top: -10px;">
                    <span style="display:inline-block; width:8px; height:8px; background:#10b981; margin-right:4px;"></span>å²—ä½æ ‡å‡†
                    <span style="display:inline-block; width:8px; height:8px; background:#2563eb; margin-left:12px; margin-right:4px;"></span>æˆ‘çš„æ°´å¹³
                </div>
            </div>

            <!-- 4. åº•éƒ¨ï¼šè¯¾ç¨‹æˆç»©æ˜ç»† -->
            <div class="section-header">è¯¾ç¨‹ä¿®è¯»è¯¦æƒ…</div>
            <div class="score-table-wrap">
                <div class="score-row" style="background: #f8fafc;">
                    <span class="score-name" style="color: #64748b; font-size: 12px;">è¯¾ç¨‹åç§°</span>
                    <span class="score-credit" style="color: #64748b;">å­¦åˆ†</span>
                    <span class="score-val" style="color: #64748b;">æˆç»©</span>
                </div>
                <div v-for="c in myJob.courseList" :key="c.name" class="score-row">
                    <span class="score-name">{{ c.name }}</span>
                    <span class="score-credit">{{ c.credit.toFixed(1) }}</span>
                    <span class="score-val" :class="c.score >= 60 ? 'val-pass' : 'val-fail'">
                        {{ c.score }}
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab Bar -->
    <div class="tab-bar" v-show="page === 'list' || currentTab === 'mine'">
        <div class="tab-item" :class="{ active: currentTab === 'list' }" @click="currentTab = 'list'; page = 'list'">
            <svg class="tab-icon" viewBox="0 0 24 24"><path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"/></svg>
            <span>è¯†å²—é€‰å²—</span>
        </div>
        <div class="tab-item" :class="{ active: currentTab === 'mine' }" @click="switchToMine">
            <svg class="tab-icon" viewBox="0 0 24 24"><path d="M12,12C14.21,12 16,10.21 16,8C16,5.79 14.21,4 12,4C9.79,4 8,5.79 8,8C8,10.21 9.79,12 12,12M12,14C9.33,14 4,15.33 4,18V20H20V18C20,15.33 14.67,14 12,14Z"/></svg>
            <span>ç›®æ ‡å²—ä½</span>
        </div>
    </div>
</div>

<script>
    const { createApp, ref, computed, nextTick, onMounted } = Vue;

    createApp({
        setup() {
            const currentTab = ref('list');
            const page = ref('list');
            const activeJob = ref(null);
            const hasSelectedJob = ref(false);
            const semesterOptions = ["2024-2025å­¦å¹´ç¬¬ä¸€å­¦æœŸ", "2024-2025å­¦å¹´ç¬¬äºŒå­¦æœŸ"];
            const selectedSemester = ref(semesterOptions[0]);
            let myChart = null;
            let radarChartInstance = null;

            // æˆ‘çš„å²—ä½ç›¸å…³æ•°æ®
            const myJob = ref({});
            const myStats = ref({ avgScore: 0, totalCredits: 0, earnedCredits: 0, progress: 0 });
            const isQualified = ref(false);

            const getStatusColor = (level) => {
                const colors = { "ä¼˜ç§€": "#10b981", "è‰¯å¥½": "#2563eb", "ä¸€èˆ¬": "#f59e0b", "è–„å¼±": "#94a3b8" };
                return colors[level] || "#94a3b8";
            };

            const getRandomNums = () => ({
                favCount: Math.floor(Math.random() * 500) + 500,
                selectCount: Math.floor(Math.random() * 2000) + 1000
            });

            const getCourseCount = (item) => {
                if (!item) return 0;
                const allCourses = Object.values(item.semesterData).flat();
                return [...new Set(allCourses)].length;
            };

            const toggleFavorite = () => {
                if (activeJob.value) {
                    activeJob.value.isFav = !activeJob.value.isFav;
                    activeJob.value.stats.favCount += activeJob.value.isFav ? 1 : -1;
                }
            };

            // ç”Ÿæˆç”¨æˆ·æˆç»©æ•°æ®
            const generateUserScores = (job) => {
                if (!job) return {};
                const allCourses = [...new Set(Object.values(job.semesterData).flat())];

                const courseList = allCourses.map(name => {
                    const credit = Math.random() > 0.5 ? 2.0 : 1.5;
                    const isPass = Math.random() > 0.15;
                    const score = isPass
                        ? Math.floor(Math.random() * (98 - 70) + 70)
                        : Math.floor(Math.random() * (59 - 40) + 40);
                    return { name, credit, score };
                });

                let totalCredits = 0;
                let earnedCredits = 0;
                let totalScoreWeighted = 0;

                courseList.forEach(c => {
                    totalCredits += c.credit;
                    if (c.score >= 60) {
                        earnedCredits += c.credit;
                    }
                    totalScoreWeighted += c.score * c.credit;
                });

                const avgScore = totalCredits > 0 ? (totalScoreWeighted / totalCredits).toFixed(1) : 0;
                const progress = totalCredits > 0 ? ((earnedCredits / totalCredits) * 100).toFixed(0) : 0;

                const qualified = progress >= 80 && avgScore >= 80;

                return {
                    ...job,
                    courseList,
                    stats: { totalCredits, earnedCredits, avgScore, progress },
                    isQualified: qualified
                };
            };

            const goToMyJobs = () => {
                hasSelectedJob.value = true;
                myJob.value = generateUserScores(activeJob.value);
                updateMyStats();
                switchToMine();
            };

            const switchToMine = () => {
                currentTab.value = 'mine';
                if (!myJob.value.name) {
                    myJob.value = generateUserScores(jobs[0]);
                    updateMyStats();
                }
                nextTick(() => {
                    initRadarChart();
                });
            };

            const updateMyStats = () => {
                if(myJob.value && myJob.value.stats) {
                    myStats.value = myJob.value.stats;
                    isQualified.value = myJob.value.isQualified;
                }
            };

            const initRadarChart = () => {
                const chartDom = document.getElementById('radarChart');
                if (!chartDom) return;

                if (radarChartInstance) radarChartInstance.dispose();
                radarChartInstance = echarts.init(chartDom);

                const baseScore = parseFloat(myStats.value.avgScore) || 75;
                const randomOffset = () => (Math.random() - 0.5) * 15;
                const clamp = (num) => Math.min(100, Math.max(40, num));

                const dataValues = [
                    clamp(baseScore + randomOffset()),
                    clamp(baseScore + randomOffset()),
                    clamp(baseScore + randomOffset()),
                    clamp(baseScore + randomOffset()),
                    clamp(baseScore + randomOffset())
                ];

                const option = {
                    color: ['#2563eb'],
                    radar: {
                        indicator: [
                            { name: 'ä¸“ä¸šçŸ¥è¯†', max: 100 },
                            { name: 'å®åŠ¡æŠ€èƒ½', max: 100 },
                            { name: 'åˆè§„æ„è¯†', max: 100 },
                            { name: 'æ²Ÿé€šåä½œ', max: 100 },
                            { name: 'ç®¡ç†èƒ½åŠ›', max: 100 }
                        ],
                        center: ['50%', '50%'],
                        radius: '65%',
                        shape: 'circle',
                        splitNumber: 4,
                        axisName: { color: '#64748b', fontSize: 11, fontWeight: '600' },
                        splitArea: { areaStyle: { color: ['#f8fafc', '#fff', '#f8fafc', '#fff'] } },
                        axisLine: { lineStyle: { color: '#e2e8f0' } },
                        splitLine: { lineStyle: { color: '#e2e8f0' } }
                    },
                    series: [{
                        type: 'radar',
                        data: [
                            {
                                value: [100, 100, 100, 100, 100],
                                name: 'å²—ä½æ ‡å‡†',
                                symbol: 'none',
                                lineStyle: { type: 'dashed', color: '#10b981' },
                                areaStyle: { color: 'none' }
                            },
                            {
                                value: dataValues.map(v => Math.floor(v)),
                                name: 'æˆ‘çš„æ°´å¹³',
                                areaStyle: { color: 'rgba(37, 99, 235, 0.2)' },
                                lineStyle: { width: 2, color: '#2563eb' },
                                symbol: 'circle',
                                symbolSize: 6
                            }
                        ]
                    }]
                };
                radarChartInstance.setOption(option);
            };

            onMounted(() => {
                myJob.value = generateUserScores(jobs[0]);
                updateMyStats();
            });

            // --- æ ¸å¿ƒä¿®æ”¹ï¼šæ¡‘æ¤¹å›¾ä¸¥æ ¼æ ¹æ®å­¦æœŸå˜åŒ–æ›´æ–° ---
            const updateChart = () => {
                if (!activeJob.value) return;
                nextTick(() => {
                    const chartDom = document.getElementById('sankeyChart');
                    if (!chartDom) return;

                    if (myChart) myChart.dispose();
                    myChart = echarts.init(chartDom);

                    // é…è‰²
                    const colors = ['#5470c6', '#91cc75', '#fac858', '#ee6666', '#73c0de', '#3ba272', '#fc8452', '#9a60b4', '#ea7ccc', '#22c55e', '#eab308', '#6366f1'];

                    const nodes = [{
                        name: activeJob.value.name,
                        itemStyle: { color: '#1e40af' }
                    }];
                    const links = [];
                    // 1. è·å–å½“å‰å­¦æœŸæ‰€æœ‰è¯¾ç¨‹ï¼ˆåŠ äº†é˜²ç©ºä¿æŠ¤ï¼‰
                    const currentCourses = activeJob.value.semesterData[selectedSemester.value] || [];

                    // 2. éå†æ‰€æœ‰èƒ½åŠ›
                    activeJob.value.matrix.forEach((ability, idx) => {
                        // 3. è¿‡æ»¤å‡ºå±äºå½“å‰å­¦æœŸçš„è¯¾ç¨‹
                        const activeInSemester = ability.activeCourses.filter(c => currentCourses.includes(c));

                        // 4. åªæœ‰å½“è¯¥èƒ½åŠ›åœ¨å½“å‰å­¦æœŸæœ‰å¯¹åº”è¯¾ç¨‹æ—¶ï¼Œæ‰æ˜¾ç¤ºè¯¥èŠ‚ç‚¹
                        if (activeInSemester.length > 0) {
                            // æ·»åŠ èƒ½åŠ›èŠ‚ç‚¹
                            nodes.push({
                                name: ability.name,
                                itemStyle: { color: colors[idx % colors.length] }
                            });

                            // æ·»åŠ  å²—ä½ -> èƒ½åŠ› çš„è¿çº¿
                            links.push({
                                source: activeJob.value.name,
                                target: ability.name,
                                value: activeInSemester.length
                            });

                            // æ·»åŠ  è¯¾ç¨‹èŠ‚ç‚¹ å’Œ èƒ½åŠ› -> è¯¾ç¨‹ çš„è¿çº¿
                            activeInSemester.forEach(course => {
                                // é˜²æ­¢è¯¾ç¨‹èŠ‚ç‚¹é‡å¤æ·»åŠ 
                                if (!nodes.find(n => n.name === course)) {
                                    nodes.push({
                                        name: course,
                                        itemStyle: { color: '#cbd5e1' }
                                    });
                                }
                                links.push({
                                    source: ability.name,
                                    target: course,
                                    value: 1
                                });
                            });
                        }
                    });

                    const option = {
                        tooltip: {
                            trigger: 'item',
                            formatter: (params) => {
                                if (params.data.source) {
                                    return `${params.data.source} â” ${params.data.target}`;
                                }
                                return params.name;
                            }
                        },
                        series: [{
                            type: 'sankey',
                            orient: 'vertical',
                            left: 10,
                            right: 10,
                            top: 20,
                            bottom: 20,
                            nodeGap: 30,   // é—´è·åŠ å¤§ï¼Œä½¿çº¿æ¡å˜ç»†
                            nodeWidth: 10,
                            lineStyle: {
                                curveness: 0.3,
                                opacity: 0.8,   // é€æ˜åº¦é™ä½ï¼Œç»†è‡´æ„Ÿ
                                color: 'source'
                            },
                            data: nodes,
                            links: links,
                            emphasis: { focus: 'adjacent' },
                            levels: [
                                { depth: 0, itemStyle: { color: '#1e40af' }, lineStyle: { color: 'source', opacity: 0.5 } },
                                { depth: 1, lineStyle: { color: 'source', opacity: 0.4 } },
                                { depth: 2, lineStyle: { color: 'source', opacity: 0.3 } }
                            ],
                            label: {
                                position: 'top',
                                fontSize: 10,
                                fontWeight: '600',
                                color: '#334155',
                                distance: 5
                            }
                        }]
                    };
                    myChart.setOption(option);
                });
            };

            // åŸæœ‰æ•°æ®ä¿æŒä¸å˜
            const jobs = [
                {
                    name: "è¯å“é‡‡è´­", dept: "é‡‡è´­éƒ¨", code: "ZY001", isFav: false,
                    stats: { myLevel: "ä¼˜ç§€", ...getRandomNums() },
                    fullDesc: "è¯å“é‡‡è´­å²—å±äºåŒ»è¯ä¼ä¸šé‡‡è´­éƒ¨ï¼Œä¸»è¦ä¿éšœè¯å“åˆè§„é«˜æ•ˆä¾›åº”ï¼Œéœ€ä¾æ®ä¸šåŠ¡ä¸åº“å­˜åˆ¶å®šé‡‡è´­è®¡åˆ’ï¼Œå¼€å‘è¯„ä¼°ä¾›åº”å•†å¹¶å®¡æ ¸èµ„è´¨ã€‚",
                    semesterData: {
                        "2024-2025å­¦å¹´ç¬¬ä¸€å­¦æœŸ": ["åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç†å­¦A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "äººä½“è§£å‰–ç”Ÿç†å­¦B", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "GSPå®åŠ¡A"],
                        "2024-2025å­¦å¹´ç¬¬äºŒå­¦æœŸ": ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡", "è¯å­¦æœåŠ¡å®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯ç‰©è­¦æˆ’A", "å®ç”¨æ–¹å‰‚ä¸ä¸­æˆè¯", "é›¶å”®è¯åº—å®åŠ¡A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C"]
                    },
                    matrix: [
                        { name: "èƒ½è§£è¯»åŒ»è¯å•†å“ä¿¡æ¯", activeCourses: ["åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç†å­¦A", "è¯å­¦æœåŠ¡å®åŠ¡A", "GSPå®åŠ¡A"] },
                        { name: "èƒ½æ”¶å®¡è¯„ä¼°ä¾›åº”å•†", activeCourses: ["GSPå®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"] },
                        { name: "èƒ½åˆ†æä¸šåŠ¡æ•°æ®", activeCourses: ["åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A"] },
                        { name: "èƒ½åˆ¶å®šé‡‡è´­è®¡åˆ’", activeCourses: ["åŒ»è¯å•†å“åŸºç¡€A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "GSPå®åŠ¡A"] },
                        { name: "èƒ½å®Œæˆä¸šåŠ¡è°ˆåˆ¤", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯å­¦æœåŠ¡å®åŠ¡A"] },
                        { name: "èƒ½å®æ–½è®¢å•è·Ÿè¸ª", activeCourses: ["åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡", "GSPå®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A"] },
                        { name: "èƒ½å¤„ç†è´¨é‡å¼‚å¸¸è¯å“", activeCourses: ["GSPå®åŠ¡A", "è¯ç‰©è­¦æˆ’A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] },
                        { name: "ç†ŸçŸ¥åŒ»è¯æ³•å¾‹æ³•è§„", activeCourses: ["è¯äº‹ç®¡ç†ä¸æ³•è§„A", "GSPå®åŠ¡A", "è¯ç‰©è­¦æˆ’A"] },
                        { name: "èƒ½è¿›è¡Œå¸‚åœºè¡Œæƒ…åˆ†æ", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡"] },
                        { name: "èƒ½è®¾è®¡é‡‡è´­è°ƒç ”æ–¹æ¡ˆ", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡"] },
                        { name: "èƒ½ç»´æŠ¤å®¢æƒ…å…³ç³»", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "è¯å­¦æœåŠ¡å®åŠ¡A"] },
                        { name: "èƒ½è¿ç”¨ç”µå­å•†åŠ¡å¹³å°", activeCourses: ["åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"] }
                    ]
                },
                {
                    name: "è¯å“é”€å”®", dept: "é”€å”®éƒ¨", code: "ZY002", isFav: false,
                    stats: { myLevel: "è‰¯å¥½", ...getRandomNums() },
                    fullDesc: "è¯å“é”€å”®å²—å±äºåŒ»è¯ä¼ä¸šé”€å”®éƒ¨ï¼ŒåŸºäºé”€å”®ç›®æ ‡è¦æ±‚ï¼Œéœ€å¼€å‘ç»´æŠ¤åŒ»é™¢ã€è¿é”è¯åº—ç­‰å®¢æˆ·ï¼Œå¼€å±•å­¦æœ¯æ¨å¹¿ä¼ é€’äº§å“ä¿¡æ¯ã€‚",
                    semesterData: {
                        "2024-2025å­¦å¹´ç¬¬ä¸€å­¦æœŸ": ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "è¯ç†å­¦A", "äººä½“è§£å‰–ç”Ÿç†å­¦B", "åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯äº‹ç®¡ç†ä¸æ³•è§„A"],
                        "2024-2025å­¦å¹´ç¬¬äºŒå­¦æœŸ": ["åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C", "é›¶å”®è¯åº—å®åŠ¡A", "å®ç”¨æ–¹å‰‚ä¸ä¸­æˆè¯", "è¯å­¦æœåŠ¡å®åŠ¡A", "è¯ç‰©è­¦æˆ’A"]
                    },
                    matrix: [
                        { name: "å‡†ç¡®è®¤ä¼ å•†å“ä¿¡æ¯", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "è¯ç†å­¦A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C", "åŒ»è¯å•†å“åŸºç¡€A", "å®ç”¨æ–¹å‰‚ä¸ä¸­æˆè¯"] },
                        { name: "èƒ½åˆ†è§£é”€å”®æŒ‡æ ‡", activeCourses: ["åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"] },
                        { name: "èƒ½æ‹œè®¿å®¢æˆ·åŠç»´æŠ¤å®¢æƒ…", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "è¯å­¦æœåŠ¡å®åŠ¡A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C"] },
                        { name: "èƒ½ç»„ç»‡å­¦æœ¯ä¼šè®®", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C", "è¯å­¦æœåŠ¡å®åŠ¡A", "è¯ç†å­¦A", "å®ç”¨æ–¹å‰‚ä¸ä¸­æˆè¯"] },
                        { name: "èƒ½æ‰§è¡Œä¿ƒé”€æ´»åŠ¨", activeCourses: ["åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡", "é›¶å”®è¯åº—å®åŠ¡A", "åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A"] },
                        { name: "èƒ½æ”¶é›†ç«å“åŠ¨æ€", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A"] },
                        { name: "èƒ½å¤„ç†ç»ˆç«¯æŠ•è¯‰", activeCourses: ["é›¶å”®è¯åº—å®åŠ¡A", "è¯å­¦æœåŠ¡å®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯ç‰©è­¦æˆ’A"] },
                        { name: "èƒ½è¿›è¡Œå­¦æœ¯æ¨å¹¿æ¼”ç¤º", activeCourses: ["è¯ç†å­¦A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C", "è¯å­¦æœåŠ¡å®åŠ¡A", "ä¸­åŒ»è¯åŸºç¡€"] },
                        { name: "èƒ½åˆ¶å®šæ‹œè®¿è®¡åˆ’çº¿è·¯", activeCourses: ["åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A"] },
                        { name: "èƒ½æ”¶é›†ä¸è‰¯ååº”ä¿¡æ¯", activeCourses: ["è¯ç‰©è­¦æˆ’A", "è¯ç†å­¦A", "è¯å­¦æœåŠ¡å®åŠ¡A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C"] },
                        { name: "èƒ½è§£è¯»åŒºåŸŸè¥é”€æ”¿ç­–", activeCourses: ["è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŒ»è¯å¸‚åœºè¥é”€å®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A"] }
                    ]
                },
                {
                    name: "è¯å­¦æœåŠ¡", dept: "é›¶å”®é—¨åº—", code: "ZY003", isFav: false,
                    stats: { myLevel: "ä¸€èˆ¬", ...getRandomNums() },
                    fullDesc: "è¯å­¦æœåŠ¡å²—å±äºé›¶å”®è¯åº—é—¨åº—ï¼Œä»¥ç”¨è¯å®‰å…¨ä¸ºæ ¸å¿ƒï¼Œä¸ºé¡¾å®¢æä¾›ç”¨è¯æŒ‡å¯¼ï¼Œè¯´æ˜ç”¨æ³•ç”¨é‡ã€ä¸è‰¯ååº”åŠæ³¨æ„äº‹é¡¹ã€‚",
                    semesterData: {
                        "2024-2025å­¦å¹´ç¬¬ä¸€å­¦æœŸ": ["ä¸­åŒ»è¯åŸºç¡€", "è¯ç†å­¦A", "äººä½“è§£å‰–ç”Ÿç†å­¦B", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŒ»è¯å•†å“åŸºç¡€A"],
                        "2024-2025å­¦å¹´ç¬¬äºŒå­¦æœŸ": ["è¯å­¦æœåŠ¡å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "å®ç”¨æ–¹å‰‚ä¸ä¸­æˆè¯", "ä¸´åºŠåŒ»å­¦åŸºç¡€C", "è¯ç‰©è­¦æˆ’A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"]
                    },
                    matrix: [
                        { name: "èƒ½æ­£ç¡®è¯¢é—®é¡¾å®¢ç—…ç—‡", activeCourses: ["ä¸´åºŠåŒ»å­¦åŸºç¡€C", "äººä½“è§£å‰–ç”Ÿç†å­¦B", "è¯å­¦æœåŠ¡å®åŠ¡A", "ä¸­åŒ»è¯åŸºç¡€"] },
                        { name: "èƒ½å¯¹ç—‡èè¯", activeCourses: ["å®ç”¨æ–¹å‰‚ä¸ä¸­æˆè¯", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç†å­¦A", "åŒ»è¯å•†å“åŸºç¡€A", "é›¶å”®è¯åº—å®åŠ¡A"] },
                        { name: "èƒ½å‡†ç¡®å®¡æ ¸å¤„æ–¹", activeCourses: ["è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯å­¦æœåŠ¡å®åŠ¡A", "è¯ç†å­¦A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C", "è¯ç‰©è­¦æˆ’A"] },
                        { name: "èƒ½è¿›è¡Œå¥åº·æŒ‡å¯¼", activeCourses: ["è¯å­¦æœåŠ¡å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "äººä½“è§£å‰–ç”Ÿç†å­¦B", "å®ç”¨æ–¹å‰‚ä¸ä¸­æˆè¯", "ä¸´åºŠåŒ»å­¦åŸºç¡€C"] },
                        { name: "èƒ½è¯„ä¼°æ…¢ç—…å¥åº·æƒ…å†µ", activeCourses: ["ä¸´åºŠåŒ»å­¦åŸºç¡€C", "è¯ç†å­¦A", "è¯å­¦æœåŠ¡å®åŠ¡A", "è¯ç‰©è­¦æˆ’A", "ä¸­åŒ»è¯åŸºç¡€"] },
                        { name: "èƒ½æŒ‡å¯¼ç”¨è¯å®‰å…¨", activeCourses: ["è¯ç†å­¦A", "è¯ç‰©è­¦æˆ’A", "è¯å­¦æœåŠ¡å®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] },
                        { name: "èƒ½é™ˆåˆ—ç»´æŠ¤è¯å“", activeCourses: ["é›¶å”®è¯åº—å®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A", "GSPå®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] },
                        { name: "èƒ½å¤„ç†é¡¾å®¢å¼‚è®®", activeCourses: ["è¯å­¦æœåŠ¡å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "ä¸­åŒ»è¯åŸºç¡€", "è¯äº‹ç®¡ç†ä¸æ³•è§„A"] },
                        { name: "èƒ½è¿›è¡Œå¥åº·å®£æ•™", activeCourses: ["è¯å­¦æœåŠ¡å®åŠ¡A", "ä¸´åºŠåŒ»å­¦åŸºç¡€C", "é›¶å”®è¯åº—å®åŠ¡A", "å®ç”¨æ–¹å‰‚ä¸ä¸­æˆè¯"] },
                        { name: "èƒ½æ“ä½œæ”¶é“¶åŠä¼šå‘˜ç³»ç»Ÿ", activeCourses: ["é›¶å”®è¯åº—å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡"] }
                    ]
                },
                {
                    name: "è´¨é‡ç®¡ç†", dept: "è´¨ç®¡éƒ¨", code: "ZY004", isFav: false,
                    stats: { myLevel: "è–„å¼±", ...getRandomNums() },
                    fullDesc: "è´¨é‡ç®¡ç†å²—å±äºåŒ»è¯ä¼ä¸šè´¨ç®¡éƒ¨ï¼Œä¸»è¦å·¥ä½œæ˜¯æ­å»ºå¹¶ç»´æŠ¤è´¨é‡ç®¡ç†ä½“ç³»ï¼Œåˆ¶å®šè´¨é‡ç®¡ç†æ–‡ä»¶ï¼Œå®¡æ ¸ä¾›åº”å•†ä¸å®¢æˆ·èµ„è´¨ã€‚",
                    semesterData: {
                        "2024-2025å­¦å¹´ç¬¬ä¸€å­¦æœŸ": ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç†å­¦A", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "äººä½“è§£å‰–ç”Ÿç†å­¦B"],
                        "2024-2025å­¦å¹´ç¬¬äºŒå­¦æœŸ": ["åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯ç‰©è­¦æˆ’A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯å­¦æœåŠ¡å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡"]
                    },
                    matrix: [
                        { name: "ç¼–å†™è´¨é‡ä½“ç³»æ–‡ä»¶", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯å­¦æœåŠ¡å®åŠ¡A"] },
                        { name: "èƒ½å¼€å±•å†…éƒ¨è´¨é‡æ£€æŸ¥", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯ç‰©è­¦æˆ’A", "é›¶å”®è¯åº—å®åŠ¡A"] },
                        { name: "èƒ½è¿›è¡Œè¯å“éªŒæ”¶æ£€æŸ¥", activeCourses: ["GSPå®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "è¯ç†å­¦A"] },
                        { name: "èƒ½å®Œæˆè¯å“å¬å›å·¥ä½œ", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯ç‰©è­¦æˆ’A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A"] },
                        { name: "èƒ½ç»„ç»‡è´¨é‡å†…å®¡", activeCourses: ["åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"] },
                        { name: "èƒ½å®¡æ ¸é¦–è¥ä¼ä¸šèµ„è´¨", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A"] },
                        { name: "èƒ½ç›‘æ§æ¸©æ¹¿åº¦ç®¡ç†", activeCourses: ["GSPå®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯ç”¨åŸºç¡€åŒ–å­¦B"] },
                        { name: "èƒ½å¼€å±•è´¨é‡åŸ¹è®­", activeCourses: ["è¯äº‹ç®¡ç†ä¸æ³•è§„A", "GSPå®åŠ¡A", "è¯ç†å­¦A", "è¯å­¦æœåŠ¡å®åŠ¡A"] },
                        { name: "èƒ½å¤„ç†è´¨é‡æŠ•è¯‰", activeCourses: ["è¯ç‰©è­¦æˆ’A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯å­¦æœåŠ¡å®åŠ¡A", "ä¸­åŒ»è¯åŸºç¡€"] },
                        { name: "èƒ½è¯„ä¼°è´¨é‡é£é™©", activeCourses: ["è¯ç‰©è­¦æˆ’A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] },
                        { name: "èƒ½åˆ¤å®šè¯å“è´¨é‡æ ‡å‡†", activeCourses: ["è¯ç†å­¦A", "åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] },
                        { name: "èƒ½æ‰§è¡Œæ•ˆæœŸç®¡ç†", activeCourses: ["GSPå®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"] }
                    ]
                },
                {
                    name: "è¯å“å‚¨å­˜", dept: "è´¨ç®¡éƒ¨", code: "ZY005", isFav: false,
                    stats: { myLevel: "ä¸€èˆ¬", ...getRandomNums() },
                    fullDesc: "è¯å“å‚¨è¿å²—å±äºåŒ»è¯ä¼ä¸šä»“å‚¨éƒ¨ï¼Œä¸»è¦è´Ÿè´£è¯å“å…¥åº“éªŒæ”¶ã€åˆ†ç±»å­˜å‚¨ã€‚ç®¡ç†åº“å­˜ç›˜ç‚¹ï¼Œæ‰§è¡Œå…ˆè¿›å…ˆå‡ºåŸåˆ™ï¼Œå¤„ç†è¿‘æ•ˆæœŸè¯å“ï¼Œä¼˜åŒ–ä»“å‚¨å¸ƒå±€ã€‚æŒ‰ç…§è¿è¾“è§„ç¨‹ï¼Œè§„èŒƒè¿›è¡Œè¯å“è¿è¾“ï¼Œä¿è¯è¯å“è´¨é‡å®‰å…¨ã€‚",
                    semesterData: {
                        "2024-2025å­¦å¹´ç¬¬ä¸€å­¦æœŸ": ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç†å­¦A", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "äººä½“è§£å‰–ç”Ÿç†å­¦B"],
                        "2024-2025å­¦å¹´ç¬¬äºŒå­¦æœŸ": ["åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯ç‰©è­¦æˆ’A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯å­¦æœåŠ¡å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡"]
                    },
                    matrix: [
                        { name: "èƒ½æ“ä½œè®¡ç®—æœºç³»ç»Ÿ", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯å­¦æœåŠ¡å®åŠ¡A"] },
                        { name: "èƒ½åˆç†å †ç æ‰˜ç›˜", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯ç‰©è­¦æˆ’A", "é›¶å”®è¯åº—å®åŠ¡A"] },
                        { name: "èƒ½æ­£ç¡®å®Œæˆè¯å“åˆ†ç±»å…¥åº“", activeCourses: ["GSPå®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "è¯ç†å­¦A"] },
                        { name: "èƒ½å®Œæˆè¯å“å¬å›å·¥ä½œ", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯ç‰©è­¦æˆ’A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A"] },
                        { name: "èƒ½å®Œæˆæ”¶è´§æ£€æŸ¥æ“ä½œ", activeCourses: ["åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"] },
                        { name: "èƒ½å®Œæˆæ”¶è´§ç¯èŠ‚å•æ®ç®¡ç†", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A"] },
                        { name: "èƒ½å®Œæˆè¯å“å‡ºåº“æ‹£é€‰ã€å¤æ ¸", activeCourses: ["GSPå®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯ç”¨åŸºç¡€åŒ–å­¦B"] },
                        { name: "èƒ½å®Œæˆé›¶è´§è¯å“æ‹¼ç®±æ“ä½œ", activeCourses: ["è¯äº‹ç®¡ç†ä¸æ³•è§„A", "GSPå®åŠ¡A", "è¯ç†å­¦A", "è¯å­¦æœåŠ¡å®åŠ¡A"] },
                        { name: "èƒ½å®Œæˆä¿æ¸©ç®±è£…ç®±æ“ä½œ", activeCourses: ["è¯ç‰©è­¦æˆ’A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯å­¦æœåŠ¡å®åŠ¡A", "ä¸­åŒ»è¯åŸºç¡€"] },
                        { name: "èƒ½å®Œæˆè¯å“è£…è½¦é…é€", activeCourses: ["è¯ç‰©è­¦æˆ’A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] },
                        { name: "èƒ½åˆ¤å®šè¯å“è´¨é‡æ ‡å‡†", activeCourses: ["è¯ç†å­¦A", "åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] }
                    ]
                },
                {
                    name: "é—¨åº—è¿è¥", dept: "é›¶å”®é—¨åº—", code: "ZY006", isFav: false,
                    stats: { myLevel: "è‰¯å¥½", ...getRandomNums() },
                    fullDesc: "é—¨åº—è¿è¥å²—å±äºé›¶å”®è¯åº—é—¨åº—ï¼Œç»Ÿç­¹è¯åº—æ—¥å¸¸è¿è¥ç®¡ç†ï¼Œåˆ¶å®šé”€å”®ä¸æ¯›åˆ©ç›®æ ‡ï¼Œåˆ†è§£è‡³å•åº—å¹¶è·Ÿè¸ªè¾¾æˆã€‚å»ºç«‹æ ‡å‡†åŒ–è¿è¥æµç¨‹ï¼Œç®¡æ§è¯å“é™ˆåˆ—ã€åº“å­˜ä¸æ•ˆæœŸï¼Œå¼€å±•ä¿ƒé”€ä¸ä¼šå‘˜æ´»åŠ¨æå‡ä¸šç»©ã€‚ç»„ç»‡å‘˜å·¥åŸ¹è®­ï¼Œæ’æŸ¥GSPåˆè§„é£é™©ï¼Œå¤„ç†é¡¾å®¢æŠ•è¯‰ä¸å®¢æƒ…ç»´æŠ¤ã€‚",
                    semesterData: {
                        "2024-2025å­¦å¹´ç¬¬ä¸€å­¦æœŸ": ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç†å­¦A", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "äººä½“è§£å‰–ç”Ÿç†å­¦B"],
                        "2024-2025å­¦å¹´ç¬¬äºŒå­¦æœŸ": ["åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯ç‰©è­¦æˆ’A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯å­¦æœåŠ¡å®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯ç”µå­å•†åŠ¡å®åŠ¡"]
                    },
                    matrix: [
                        { name: "èƒ½è§£è¯»åŒ»è¯å•†å“ä¿¡æ¯", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯å­¦æœåŠ¡å®åŠ¡A"] },
                        { name: "èƒ½æ“ä½œè®¡ç®—æœºç³»ç»Ÿ", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯ç‰©è­¦æˆ’A", "é›¶å”®è¯åº—å®åŠ¡A"] },
                        { name: "èƒ½è¿›è¡Œå²—ä½å·¥ä½œæ€»ç»“", activeCourses: ["GSPå®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "è¯ç†å­¦A"] },
                        { name: "èƒ½å®Œæˆè¯å“å¬å›å·¥ä½œ", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯ç‰©è­¦æˆ’A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A"] },
                        { name: "èƒ½æ‰§è¡Œä¿ƒé”€æ´»åŠ¨", activeCourses: ["åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"] },
                        { name: "èƒ½ç†ŸçŸ¥åŒ»è¯æ³•å¾‹æ³•è§„", activeCourses: ["GSPå®åŠ¡A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A"] },
                        { name: "èƒ½æ­£ç¡®å›å¤é¡¾å®¢ç”¨è¯å’¨è¯¢", activeCourses: ["GSPå®åŠ¡A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C", "è¯ç”¨åŸºç¡€åŒ–å­¦B"] },
                        { name: "èƒ½åœ¨åº“è¯å“è¿›è¡Œè¿‘æ•ˆæœŸç®¡ç†", activeCourses: ["è¯äº‹ç®¡ç†ä¸æ³•è§„A", "GSPå®åŠ¡A", "è¯ç†å­¦A", "è¯å­¦æœåŠ¡å®åŠ¡A"] },
                        { name: "èƒ½å®Œæˆè¯åº—é—¨åº—å¸ƒå±€è®¾è®¡", activeCourses: ["è¯ç‰©è­¦æˆ’A", "è¯äº‹ç®¡ç†ä¸æ³•è§„A", "è¯å­¦æœåŠ¡å®åŠ¡A", "ä¸­åŒ»è¯åŸºç¡€"] },
                        { name: "èƒ½å®Œæˆé—¨åº—è¯·è´§", activeCourses: ["è¯ç‰©è­¦æˆ’A", "åŒ»è¯ä¼ä¸šç®¡ç†å®åŠ¡A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] },
                        { name: "èƒ½åˆ†æé¡¾å®¢éœ€æ±‚", activeCourses: ["è¯ç†å­¦A", "åŒ»è¯å•†å“åŸºç¡€A", "ä¸­åŒ»è¯åŸºç¡€", "è¯ç”¨åŸºç¡€åŒ–å­¦B", "è¯ç‰©åˆ¶å‰‚æŠ€æœ¯C"] },
                        { name: "èƒ½ç®¡ç†é—¨åº—è¥ä¸šåœºæ‰€", activeCourses: ["GSPå®åŠ¡A", "é›¶å”®è¯åº—å®åŠ¡A", "åŒ»è¯å•†å“åŸºç¡€A", "åŸºç¡€ä¼šè®¡ä¸å®åŠ¡A"] }
                    ]
                }
            ];

            const currentSemesterCourses = computed(() => {
                if (!activeJob.value) return [];
                return activeJob.value.semesterData[selectedSemester.value] || [];
            });

            const openDetail = (item) => {
                activeJob.value = item;
                page.value = 'detail';
                window.scrollTo(0, 0);
                updateChart();
            };

            window.addEventListener('resize', () => {
                if (myChart) myChart.resize();
                if (radarChartInstance) radarChartInstance.resize();
            });

            return {
                currentTab, page, jobs, activeJob, hasSelectedJob,
                openDetail, semesterOptions, selectedSemester,
                currentSemesterCourses, getStatusColor, getCourseCount, goToMyJobs,
                toggleFavorite, updateChart,
                myJob, myStats, isQualified, switchToMine
            };
        }
    }).mount('#app');
</script>
</body>
</html>
